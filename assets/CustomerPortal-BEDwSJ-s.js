import{Q as I,J as B,j as E,N as b,A as m,x as e}from"./index-BN9GAmQT.js";import{B as r}from"./button-B7XicF_D.js";import{C as x,a as N,b as w,c as f,d as y}from"./card-DDCG5iAJ.js";import{B as a}from"./badge-DuBy3M6P.js";import{D as R,a as A,b as z,c as H}from"./dialog-BFxkyGdG.js";import{L as M}from"./loader-circle-ClqFH6Ch.js";import{L as K}from"./log-out-Del1bcAp.js";import{B as O}from"./building-2-CncIBXM4.js";import{F as g}from"./file-text-zOWEdpec.js";import{C as T}from"./calendar-lP7qctBn.js";import{D as U}from"./dollar-sign-BhOElyIN.js";import{E as G}from"./eye-DH5-FCbl.js";import{D as v}from"./download-_y-9cJJ1.js";import"./index-Ci_qB1WW.js";import"./index-DkLA8Hun.js";function le(){const{user:n,loading:D}=I(),[,u]=B(),[p,i]=E.useState(null),l=[],k=!1,h=b.auth.logout.useMutation({onSuccess:()=>{m.success("Erfolgreich abgemeldet"),u("/login")}}),c=b.pdf.generateInvoicePDF.useMutation({onSuccess:t=>{const d=atob(t.data),j=new Array(d.length);for(let o=0;o<d.length;o++)j[o]=d.charCodeAt(o);const L=new Uint8Array(j),S=new Blob([L],{type:"application/pdf"}),F=window.URL.createObjectURL(S);window.open(F,"_blank"),m.success("PDF wird geöffnet")},onError:t=>{m.error(`Fehler: ${t.message}`)}});if(D||k)return e.jsx("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:55",className:"min-h-screen flex items-center justify-center bg-black",children:e.jsx(M,{"data-loc":"client/src/pages/CustomerPortal.tsx:56",className:"h-8 w-8 animate-spin text-primary"})});if(!n||n.role!=="user")return u("/login"),null;const C=t=>{switch(t){case"draft":return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:69",className:"bg-gray-500/20 text-gray-400 border-gray-500/30",children:"Entwurf"});case"sent":return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:71",className:"bg-blue-500/20 text-blue-400 border-blue-500/30",children:"Versendet"});case"paid":return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:73",className:"bg-green-500/20 text-green-400 border-green-500/30",children:"Bezahlt"});case"overdue":return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:75",className:"bg-red-500/20 text-red-400 border-red-500/30",children:"Überfällig"});case"cancelled":return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:77",className:"bg-orange-500/20 text-orange-400 border-orange-500/30",children:"Storniert"});default:return e.jsx(a,{"data-loc":"client/src/pages/CustomerPortal.tsx:79",className:"bg-gray-500/20 text-gray-400 border-gray-500/30",children:t})}},P=t=>new Intl.NumberFormat("de-CH",{style:"currency",currency:"CHF"}).format(t),s=l?.find(t=>t.id===p);return e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:93",className:"min-h-screen bg-black text-white",children:[e.jsx("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:95",className:"border-b border-white/10 bg-white/5 backdrop-blur-xl",children:e.jsx("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:96",className:"container mx-auto px-4 py-4",children:e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:97",className:"flex justify-between items-center",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:98",children:[e.jsx("h1",{"data-loc":"client/src/pages/CustomerPortal.tsx:99",className:"text-xl md:text-2xl font-bold",children:"Kundenportal"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:100",className:"text-xs md:text-sm text-gray-400",children:"Ihre Rechnungen und Dokumente"})]}),e.jsx("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:102",className:"flex items-center gap-2",children:e.jsxs(r,{"data-loc":"client/src/pages/CustomerPortal.tsx:103",variant:"outline",onClick:()=>h.mutate(),disabled:h.isPending,className:"border-white/20 bg-white/5 hover:bg-white/10",size:"sm",children:[e.jsx(K,{"data-loc":"client/src/pages/CustomerPortal.tsx:110",className:"h-4 w-4 md:mr-2"}),e.jsx("span",{"data-loc":"client/src/pages/CustomerPortal.tsx:111",className:"hidden md:inline",children:"Abmelden"})]})})]})})}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:119",className:"container mx-auto px-4 py-8",children:[e.jsx(x,{"data-loc":"client/src/pages/CustomerPortal.tsx:121",className:"bg-white/5 border-white/10 mb-8",children:e.jsxs(N,{"data-loc":"client/src/pages/CustomerPortal.tsx:122",children:[e.jsxs(w,{"data-loc":"client/src/pages/CustomerPortal.tsx:123",className:"text-white flex items-center gap-2",children:[e.jsx(O,{"data-loc":"client/src/pages/CustomerPortal.tsx:124",className:"h-5 w-5 text-primary"}),"Willkommen, ",n.name||"Kunde"]}),e.jsx(f,{"data-loc":"client/src/pages/CustomerPortal.tsx:127",className:"text-gray-400",children:"Hier finden Sie alle Ihre Rechnungen und können diese als PDF herunterladen."})]})}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:134",className:"space-y-4",children:[e.jsx("h2",{"data-loc":"client/src/pages/CustomerPortal.tsx:135",className:"text-xl font-bold mb-4",children:"Ihre Rechnungen"}),!l||l.length===0?e.jsx(x,{"data-loc":"client/src/pages/CustomerPortal.tsx:138",className:"bg-white/5 border-white/10",children:e.jsxs(y,{"data-loc":"client/src/pages/CustomerPortal.tsx:139",className:"py-12 text-center",children:[e.jsx(g,{"data-loc":"client/src/pages/CustomerPortal.tsx:140",className:"h-12 w-12 mx-auto mb-4 text-gray-500"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:141",className:"text-gray-400",children:"Noch keine Rechnungen vorhanden"})]})}):l.map(t=>e.jsxs(x,{"data-loc":"client/src/pages/CustomerPortal.tsx:146",className:"bg-white/5 border-white/10 hover:bg-white/10 transition-colors",children:[e.jsx(N,{"data-loc":"client/src/pages/CustomerPortal.tsx:147",children:e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:148",className:"flex items-start justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:149",children:[e.jsxs(w,{"data-loc":"client/src/pages/CustomerPortal.tsx:150",className:"text-white flex items-center gap-2",children:[e.jsx(g,{"data-loc":"client/src/pages/CustomerPortal.tsx:151",className:"h-5 w-5 text-primary"}),"Rechnung ",t.invoiceNumber]}),e.jsx(f,{"data-loc":"client/src/pages/CustomerPortal.tsx:154",className:"text-gray-400 mt-1",children:t.description||"Keine Beschreibung"})]}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:158",className:"flex flex-col items-end gap-2",children:[C(t.status),e.jsx("span",{"data-loc":"client/src/pages/CustomerPortal.tsx:160",className:"text-lg font-bold text-white",children:P(t.totalAmount)})]})]})}),e.jsx(y,{"data-loc":"client/src/pages/CustomerPortal.tsx:166",children:e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:167",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:168",className:"space-y-1 text-sm text-gray-400",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:169",className:"flex items-center gap-2",children:[e.jsx(T,{"data-loc":"client/src/pages/CustomerPortal.tsx:170",className:"h-4 w-4"}),e.jsxs("span",{"data-loc":"client/src/pages/CustomerPortal.tsx:171",children:["Datum: ",new Date(t.invoiceDate).toLocaleDateString("de-DE")]})]}),t.dueDate&&e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:174",className:"flex items-center gap-2",children:[e.jsx(U,{"data-loc":"client/src/pages/CustomerPortal.tsx:175",className:"h-4 w-4"}),e.jsxs("span",{"data-loc":"client/src/pages/CustomerPortal.tsx:176",children:["Fällig: ",new Date(t.dueDate).toLocaleDateString("de-DE")]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:180",className:"flex items-center gap-2",children:[e.jsxs(r,{"data-loc":"client/src/pages/CustomerPortal.tsx:181",variant:"outline",size:"sm",onClick:()=>i(t.id),className:"border-white/20 bg-white/5 hover:bg-white/10",children:[e.jsx(G,{"data-loc":"client/src/pages/CustomerPortal.tsx:187",className:"h-4 w-4 mr-2"}),"Details"]}),e.jsxs(r,{"data-loc":"client/src/pages/CustomerPortal.tsx:190",variant:"default",size:"sm",onClick:()=>c.mutate({invoiceId:t.id}),disabled:c.isPending,className:"bg-primary hover:bg-primary/90",children:[e.jsx(v,{"data-loc":"client/src/pages/CustomerPortal.tsx:197",className:"h-4 w-4 mr-2"}),"PDF"]})]})]})})]},t.id))]})]}),s&&e.jsx(R,{"data-loc":"client/src/pages/CustomerPortal.tsx:211",open:!!p,onOpenChange:()=>i(null),children:e.jsxs(A,{"data-loc":"client/src/pages/CustomerPortal.tsx:212",className:"bg-black/95 border-white/20 text-white max-w-3xl max-h-[80vh] overflow-y-auto",children:[e.jsx(z,{"data-loc":"client/src/pages/CustomerPortal.tsx:213",children:e.jsxs(H,{"data-loc":"client/src/pages/CustomerPortal.tsx:214",className:"flex items-center gap-2",children:[e.jsx(g,{"data-loc":"client/src/pages/CustomerPortal.tsx:215",className:"h-5 w-5 text-primary"}),"Rechnung ",s.invoiceNumber]})}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:219",className:"space-y-6 mt-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:221",className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:222",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:223",className:"text-sm text-gray-400",children:"Status"}),e.jsx("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:224",className:"mt-1",children:C(s.status)})]}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:226",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:227",className:"text-sm text-gray-400",children:"Rechnungsdatum"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:228",className:"text-white mt-1",children:new Date(s.invoiceDate).toLocaleDateString("de-DE")})]}),s.dueDate&&e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:233",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:234",className:"text-sm text-gray-400",children:"Fälligkeitsdatum"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:235",className:"text-white mt-1",children:new Date(s.dueDate).toLocaleDateString("de-DE")})]}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:240",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:241",className:"text-sm text-gray-400",children:"Gesamtbetrag"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:242",className:"text-white text-lg font-bold mt-1",children:P(s.totalAmount)})]})]}),s.description&&e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:250",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:251",className:"text-sm text-gray-400 mb-2",children:"Beschreibung"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:252",className:"text-white",children:s.description})]}),s.notes&&e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:258",children:[e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:259",className:"text-sm text-gray-400 mb-2",children:"Notizen"}),e.jsx("p",{"data-loc":"client/src/pages/CustomerPortal.tsx:260",className:"text-white",children:s.notes})]}),e.jsxs("div",{"data-loc":"client/src/pages/CustomerPortal.tsx:265",className:"flex gap-2 pt-4 border-t border-white/10",children:[e.jsxs(r,{"data-loc":"client/src/pages/CustomerPortal.tsx:266",variant:"default",onClick:()=>c.mutate({invoiceId:s.id}),disabled:c.isPending,className:"bg-primary hover:bg-primary/90",children:[e.jsx(v,{"data-loc":"client/src/pages/CustomerPortal.tsx:272",className:"h-4 w-4 mr-2"}),"PDF herunterladen"]}),e.jsx(r,{"data-loc":"client/src/pages/CustomerPortal.tsx:275",variant:"outline",onClick:()=>i(null),className:"border-white/20 bg-white/5 hover:bg-white/10",children:"Schließen"})]})]})]})})]})}export{le as default};

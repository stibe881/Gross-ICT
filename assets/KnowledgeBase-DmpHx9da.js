import{Q as J,J as R,j as n,N as i,A as l,x as e}from"./index-BN9GAmQT.js";import{B as r}from"./button-B7XicF_D.js";import{I as p}from"./input-DAxyQcQ6.js";import{T as Z}from"./textarea-CUpb7IQY.js";import{C as S,d as C,a as X,b as Y}from"./card-DDCG5iAJ.js";import{B as u}from"./badge-DuBy3M6P.js";import{D as _,d as $,a as ee,b as se,c as ae}from"./dialog-BFxkyGdG.js";import{S as B,a as K,b as j,c as b,d as c}from"./select-lpC4X7iX.js";import{L as o}from"./label-WV9rmlgK.js";import{A as te}from"./arrow-left-DYl8JD6p.js";import{P as le}from"./plus-Bs9J4-Yt.js";import{G as A}from"./globe-BNcIRui1.js";import{L as z}from"./lock-CN5MT7S2.js";import{S as ce}from"./search-DYS7RNfR.js";import{S as ne}from"./square-pen-CPfJwZSi.js";import{T as ie}from"./trash-2-BGEcaC5X.js";import{E as re}from"./eye-DH5-FCbl.js";import{T as oe}from"./thumbs-up-D8P2B3QF.js";import"./index-Ci_qB1WW.js";import"./index-DkLA8Hun.js";import"./index-DYYK5dbJ.js";import"./index-FM6g0UGI.js";import"./chevron-up-CGjsbtlF.js";import"./check-B0XS7teL.js";import"./index-BxbciWQS.js";function Ie(){const{user:T}=J(),[,E]=R(),[v,L]=n.useState(""),[f,F]=n.useState(""),[N,I]=n.useState(""),[M,d]=n.useState(!1),[g,x]=n.useState(null),[a,t]=n.useState({title:"",content:"",category:"",tags:"",visibility:"public"}),m=i.useUtils(),D=T?.role==="admin",{data:w,isLoading:P}=i.kb.all.useQuery({search:v||void 0,category:f||void 0,visibility:N||void 0}),{data:V}=i.kb.categories.useQuery(),y=i.kb.create.useMutation({onSuccess:()=>{l.success("Artikel erstellt"),d(!1),h(),m.kb.all.invalidate()},onError:s=>{l.error(s.message||"Fehler beim Erstellen")}}),k=i.kb.update.useMutation({onSuccess:()=>{l.success("Artikel aktualisiert"),x(null),h(),m.kb.all.invalidate()},onError:s=>{l.error(s.message||"Fehler beim Aktualisieren")}}),Q=i.kb.delete.useMutation({onSuccess:()=>{l.success("Artikel gelöscht"),m.kb.all.invalidate()},onError:s=>{l.error(s.message||"Fehler beim Löschen")}}),h=()=>{t({title:"",content:"",category:"",tags:"",visibility:"public"})},H=()=>{if(!a.title||!a.content||!a.category){l.error("Bitte füllen Sie alle Pflichtfelder aus");return}g?k.mutate({id:g.id,...a}):y.mutate(a)},O=s=>{x(s),t({title:s.title,content:s.content,category:s.category,tags:s.tags||"",visibility:s.visibility}),d(!0)},G=s=>{confirm("Möchten Sie diesen Artikel wirklich löschen?")&&Q.mutate({id:s})},U=s=>s==="internal"?e.jsx(z,{"data-loc":"client/src/pages/KnowledgeBase.tsx:136",className:"h-4 w-4"}):e.jsx(A,{"data-loc":"client/src/pages/KnowledgeBase.tsx:138",className:"h-4 w-4"});return e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:143",className:"min-h-screen bg-black text-white",children:[e.jsx("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:145",className:"border-b border-white/10 bg-zinc-900/50 backdrop-blur-sm sticky top-0 z-10",children:e.jsx("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:146",className:"container mx-auto px-4 py-4",children:e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:147",className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:148",className:"flex items-center gap-4",children:[e.jsxs(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:149",variant:"ghost",onClick:()=>E("/admin"),size:"sm",children:[e.jsx(te,{"data-loc":"client/src/pages/KnowledgeBase.tsx:154",className:"h-4 w-4 mr-2"}),"Zurück"]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:157",children:[e.jsx("h1",{"data-loc":"client/src/pages/KnowledgeBase.tsx:158",className:"text-2xl font-bold",children:"Wissensdatenbank"}),e.jsx("p",{"data-loc":"client/src/pages/KnowledgeBase.tsx:159",className:"text-gray-400 text-sm",children:"Verwalten Sie FAQ und Lösungsartikel"})]})]}),e.jsxs(_,{"data-loc":"client/src/pages/KnowledgeBase.tsx:162",open:M,onOpenChange:d,children:[e.jsx($,{"data-loc":"client/src/pages/KnowledgeBase.tsx:163",asChild:!0,children:e.jsxs(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:164",onClick:()=>{x(null),h()},children:[e.jsx(le,{"data-loc":"client/src/pages/KnowledgeBase.tsx:165",className:"h-4 w-4 mr-2"}),"Neuer Artikel"]})}),e.jsxs(ee,{"data-loc":"client/src/pages/KnowledgeBase.tsx:169",className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-zinc-900 border-white/10",children:[e.jsx(se,{"data-loc":"client/src/pages/KnowledgeBase.tsx:170",children:e.jsx(ae,{"data-loc":"client/src/pages/KnowledgeBase.tsx:171",className:"text-white",children:g?"Artikel bearbeiten":"Neuer Artikel"})}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:175",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:176",children:[e.jsx(o,{"data-loc":"client/src/pages/KnowledgeBase.tsx:177",htmlFor:"title",className:"text-gray-300",children:"Titel *"}),e.jsx(p,{"data-loc":"client/src/pages/KnowledgeBase.tsx:178",id:"title",value:a.title,onChange:s=>t({...a,title:s.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"z.B. Wie setze ich mein Passwort zurück?"})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:186",children:[e.jsx(o,{"data-loc":"client/src/pages/KnowledgeBase.tsx:187",htmlFor:"category",className:"text-gray-300",children:"Kategorie *"}),e.jsx(p,{"data-loc":"client/src/pages/KnowledgeBase.tsx:188",id:"category",value:a.category,onChange:s=>t({...a,category:s.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"z.B. Passwörter, E-Mail, Netzwerk"})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:196",children:[e.jsx(o,{"data-loc":"client/src/pages/KnowledgeBase.tsx:197",htmlFor:"visibility",className:"text-gray-300",children:"Sichtbarkeit *"}),e.jsxs(B,{"data-loc":"client/src/pages/KnowledgeBase.tsx:198",value:a.visibility,onValueChange:s=>t({...a,visibility:s}),children:[e.jsx(K,{"data-loc":"client/src/pages/KnowledgeBase.tsx:202",className:"bg-white/5 border-white/10 text-white",children:e.jsx(j,{"data-loc":"client/src/pages/KnowledgeBase.tsx:203"})}),e.jsxs(b,{"data-loc":"client/src/pages/KnowledgeBase.tsx:205",className:"bg-zinc-800 border-white/10",children:[e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:206",value:"public",children:e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:207",className:"flex items-center gap-2",children:[e.jsx(A,{"data-loc":"client/src/pages/KnowledgeBase.tsx:208",className:"h-4 w-4"}),"Öffentlich (Kunden können sehen)"]})}),e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:212",value:"internal",children:e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:213",className:"flex items-center gap-2",children:[e.jsx(z,{"data-loc":"client/src/pages/KnowledgeBase.tsx:214",className:"h-4 w-4"}),"Intern (nur Mitarbeitende)"]})})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:221",children:[e.jsx(o,{"data-loc":"client/src/pages/KnowledgeBase.tsx:222",htmlFor:"tags",className:"text-gray-300",children:"Tags (kommagetrennt)"}),e.jsx(p,{"data-loc":"client/src/pages/KnowledgeBase.tsx:223",id:"tags",value:a.tags,onChange:s=>t({...a,tags:s.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"z.B. passwort, reset, login"})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:231",children:[e.jsx(o,{"data-loc":"client/src/pages/KnowledgeBase.tsx:232",htmlFor:"content",className:"text-gray-300",children:"Inhalt (Markdown unterstützt) *"}),e.jsx(Z,{"data-loc":"client/src/pages/KnowledgeBase.tsx:233",id:"content",value:a.content,onChange:s=>t({...a,content:s.target.value}),className:"bg-white/5 border-white/10 text-white min-h-[300px]",placeholder:"Schreiben Sie hier die Lösung..."})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:241",className:"flex justify-end gap-2",children:[e.jsx(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:242",variant:"outline",onClick:()=>{d(!1),x(null),h()},children:"Abbrechen"}),e.jsx(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:248",onClick:H,disabled:y.isPending||k.isPending,children:g?"Aktualisieren":"Erstellen"})]})]})]})]})]})})}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:263",className:"container mx-auto px-4 py-6",children:[e.jsx(S,{"data-loc":"client/src/pages/KnowledgeBase.tsx:264",className:"bg-zinc-900/50 border-white/10 mb-6",children:e.jsx(C,{"data-loc":"client/src/pages/KnowledgeBase.tsx:265",className:"p-4",children:e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:266",className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:267",className:"relative",children:[e.jsx(ce,{"data-loc":"client/src/pages/KnowledgeBase.tsx:268",className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(p,{"data-loc":"client/src/pages/KnowledgeBase.tsx:269",value:v,onChange:s=>L(s.target.value),placeholder:"Suche nach Titel, Inhalt oder Tags...",className:"pl-10 bg-white/5 border-white/10 text-white"})]}),e.jsxs(B,{"data-loc":"client/src/pages/KnowledgeBase.tsx:276",value:f||"all",onValueChange:s=>F(s==="all"?"":s),children:[e.jsx(K,{"data-loc":"client/src/pages/KnowledgeBase.tsx:277",className:"bg-white/5 border-white/10 text-white",children:e.jsx(j,{"data-loc":"client/src/pages/KnowledgeBase.tsx:278",placeholder:"Alle Kategorien"})}),e.jsxs(b,{"data-loc":"client/src/pages/KnowledgeBase.tsx:280",className:"bg-zinc-800 border-white/10",children:[e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:281",value:"all",children:"Alle Kategorien"}),V?.map(s=>e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:283",value:s,children:s},s))]})]}),e.jsxs(B,{"data-loc":"client/src/pages/KnowledgeBase.tsx:289",value:N||"all",onValueChange:s=>I(s==="all"?"":s),children:[e.jsx(K,{"data-loc":"client/src/pages/KnowledgeBase.tsx:290",className:"bg-white/5 border-white/10 text-white",children:e.jsx(j,{"data-loc":"client/src/pages/KnowledgeBase.tsx:291",placeholder:"Alle Sichtbarkeiten"})}),e.jsxs(b,{"data-loc":"client/src/pages/KnowledgeBase.tsx:293",className:"bg-zinc-800 border-white/10",children:[e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:294",value:"all",children:"Alle"}),e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:295",value:"public",children:"Öffentlich"}),e.jsx(c,{"data-loc":"client/src/pages/KnowledgeBase.tsx:296",value:"internal",children:"Intern"})]})]})]})})}),P?e.jsx("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:305",className:"text-center py-12 text-gray-400",children:"Lädt..."}):w&&w.length>0?e.jsx("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:307",className:"grid grid-cols-1 gap-4",children:w.map(s=>e.jsxs(S,{"data-loc":"client/src/pages/KnowledgeBase.tsx:309",className:"bg-zinc-900/50 border-white/10 hover:border-white/20 transition-colors",children:[e.jsx(X,{"data-loc":"client/src/pages/KnowledgeBase.tsx:310",children:e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:311",className:"flex justify-between items-start gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:312",className:"flex-1",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:313",className:"flex items-center gap-2 mb-2",children:[e.jsx(Y,{"data-loc":"client/src/pages/KnowledgeBase.tsx:314",className:"text-white text-lg",children:s.title}),e.jsxs(u,{"data-loc":"client/src/pages/KnowledgeBase.tsx:315",variant:"outline",className:"text-xs",children:[U(s.visibility),e.jsx("span",{"data-loc":"client/src/pages/KnowledgeBase.tsx:317",className:"ml-1",children:s.visibility==="internal"?"Intern":"Öffentlich"})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:322",className:"flex flex-wrap gap-2 text-sm text-gray-400",children:[e.jsx(u,{"data-loc":"client/src/pages/KnowledgeBase.tsx:323",variant:"secondary",children:s.category}),s.tags&&s.tags.split(",").map((W,q)=>e.jsx(u,{"data-loc":"client/src/pages/KnowledgeBase.tsx:325",variant:"outline",className:"text-xs",children:W.trim()},q))]})]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:331",className:"flex gap-2",children:[e.jsx(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:332",variant:"ghost",size:"sm",onClick:()=>O(s),children:e.jsx(ne,{"data-loc":"client/src/pages/KnowledgeBase.tsx:337",className:"h-4 w-4"})}),D&&e.jsx(r,{"data-loc":"client/src/pages/KnowledgeBase.tsx:340",variant:"ghost",size:"sm",onClick:()=>G(s.id),children:e.jsx(ie,{"data-loc":"client/src/pages/KnowledgeBase.tsx:345",className:"h-4 w-4 text-red-400"})})]})]})}),e.jsxs(C,{"data-loc":"client/src/pages/KnowledgeBase.tsx:351",children:[e.jsx("p",{"data-loc":"client/src/pages/KnowledgeBase.tsx:352",className:"text-gray-300 line-clamp-2 mb-3",children:s.content}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:353",className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:354",className:"flex items-center gap-1",children:[e.jsx(re,{"data-loc":"client/src/pages/KnowledgeBase.tsx:355",className:"h-4 w-4"}),s.viewCount," Aufrufe"]}),e.jsxs("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:358",className:"flex items-center gap-1",children:[e.jsx(oe,{"data-loc":"client/src/pages/KnowledgeBase.tsx:359",className:"h-4 w-4"}),s.helpfulCount," Hilfreich"]})]})]})]},s.id))}):e.jsx("div",{"data-loc":"client/src/pages/KnowledgeBase.tsx:368",className:"text-center py-12 text-gray-400",children:"Keine Artikel gefunden. Erstellen Sie Ihren ersten Artikel!"})]})]})}export{Ie as default};

import{c as A,J as F,j,N as l,A as n,x as e}from"./index-BN9GAmQT.js";import{C as w,a as T,b as I,c as O,d as b}from"./card-DDCG5iAJ.js";import{B as i}from"./button-B7XicF_D.js";import{I as p}from"./input-DAxyQcQ6.js";import{L as d}from"./label-WV9rmlgK.js";import{S as v,a as N,b as f,c as y,d as t}from"./select-lpC4X7iX.js";import{D as V,d as H,a as K,b as Z,c as q,e as J}from"./dialog-BFxkyGdG.js";import{B as o}from"./badge-DuBy3M6P.js";import{A as Q}from"./arrow-left-DYl8JD6p.js";import{U as B}from"./users-BEPVjVsG.js";import{M as C}from"./mail-fgvT38PL.js";import{T as $}from"./trash-2-BGEcaC5X.js";import{S as G}from"./shield-D17cGoL0.js";import{U as S}from"./user-DNKQZcJU.js";import"./index-Ci_qB1WW.js";import"./index-BxbciWQS.js";import"./index-DYYK5dbJ.js";import"./index-DkLA8Hun.js";import"./index-FM6g0UGI.js";import"./chevron-up-CGjsbtlF.js";import"./check-B0XS7teL.js";const W=A("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function Ue(){const[,h]=F(),[z,u]=j.useState(!1),[s,r]=j.useState({name:"",email:"",password:"",role:"user"}),g=l.useUtils(),{data:m,isLoading:k}=l.users.all.useQuery(),x=l.users.create.useMutation({onSuccess:()=>{n.success("Benutzer erfolgreich erstellt"),u(!1),r({name:"",email:"",password:"",role:"user"}),g.users.all.invalidate()},onError:a=>{n.error(a.message||"Fehler beim Erstellen des Benutzers")}}),M=l.users.updateRole.useMutation({onSuccess:()=>{n.success("Rolle erfolgreich geändert"),g.users.all.invalidate()},onError:a=>{n.error(a.message||"Fehler beim Ändern der Rolle")}}),U=l.users.delete.useMutation({onSuccess:()=>{n.success("Benutzer erfolgreich gelöscht"),g.users.all.invalidate()},onError:a=>{n.error(a.message||"Fehler beim Löschen des Benutzers")}}),D=()=>{if(!s.name||!s.email||!s.password){n.error("Bitte füllen Sie alle Felder aus");return}x.mutate(s)},E=(a,c)=>{M.mutate({userId:a,role:c})},L=(a,c)=>{confirm(`Möchten Sie den Benutzer "${c}" wirklich löschen?`)&&U.mutate({userId:a})},R=a=>{switch(a){case"admin":return e.jsx(o,{"data-loc":"client/src/pages/UserManagement.tsx:80",className:"bg-red-500/20 text-red-400 border-red-500/30",children:"Admin"});case"support":return e.jsx(o,{"data-loc":"client/src/pages/UserManagement.tsx:82",className:"bg-blue-500/20 text-blue-400 border-blue-500/30",children:"Support"});case"accounting":return e.jsx(o,{"data-loc":"client/src/pages/UserManagement.tsx:84",className:"bg-green-500/20 text-green-400 border-green-500/30",children:"Buchhaltung"});default:return e.jsx(o,{"data-loc":"client/src/pages/UserManagement.tsx:86",className:"bg-gray-500/20 text-gray-400 border-gray-500/30",children:"Benutzer"})}},P=a=>a==="admin"?e.jsx(G,{"data-loc":"client/src/pages/UserManagement.tsx:91",className:"h-4 w-4 text-red-400"}):a==="support"?e.jsx(S,{"data-loc":"client/src/pages/UserManagement.tsx:92",className:"h-4 w-4 text-blue-400"}):e.jsx(S,{"data-loc":"client/src/pages/UserManagement.tsx:93",className:"h-4 w-4 text-gray-400"});return k?e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:98",className:"min-h-screen bg-black text-white flex items-center justify-center",children:e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:99",className:"text-center",children:[e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:100",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{"data-loc":"client/src/pages/UserManagement.tsx:101",className:"text-gray-400",children:"Lade Benutzerverwaltung..."})]})}):e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:108",className:"min-h-screen bg-black text-white p-6",children:e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:109",className:"container mx-auto max-w-7xl",children:[e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:111",className:"mb-8",children:e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:112",className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:113",className:"flex items-center gap-4",children:[e.jsxs(i,{"data-loc":"client/src/pages/UserManagement.tsx:114",variant:"ghost",onClick:()=>h("/admin"),size:"sm",children:[e.jsx(Q,{"data-loc":"client/src/pages/UserManagement.tsx:119",className:"h-4 w-4 mr-2"}),"Zurück"]}),e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:122",children:e.jsxs("h1",{"data-loc":"client/src/pages/UserManagement.tsx:123",className:"text-2xl md:text-3xl font-bold flex items-center gap-2 md:gap-3",children:[e.jsx(B,{"data-loc":"client/src/pages/UserManagement.tsx:124",className:"h-6 w-6 md:h-8 md:w-8 text-primary"}),"Benutzerverwaltung"]})})]}),e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:129",children:e.jsx("p",{"data-loc":"client/src/pages/UserManagement.tsx:130",className:"text-sm md:text-base text-gray-400 mt-1 md:mt-2",children:"Verwalten Sie Benutzer und deren Rollen"})}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:132",className:"flex gap-2",children:[e.jsxs(i,{"data-loc":"client/src/pages/UserManagement.tsx:133",variant:"outline",onClick:()=>h("/smtp-settings"),size:"sm",children:[e.jsx(C,{"data-loc":"client/src/pages/UserManagement.tsx:138",className:"h-4 w-4 mr-2"}),"SMTP Einstellungen"]}),e.jsxs(V,{"data-loc":"client/src/pages/UserManagement.tsx:141",open:z,onOpenChange:u,children:[e.jsx(H,{"data-loc":"client/src/pages/UserManagement.tsx:142",asChild:!0,children:e.jsxs(i,{"data-loc":"client/src/pages/UserManagement.tsx:143",className:"bg-primary hover:bg-primary/80 w-full md:w-auto",size:"sm",children:[e.jsx(W,{"data-loc":"client/src/pages/UserManagement.tsx:144",className:"h-4 w-4 mr-2"}),"Neuer Benutzer"]})}),e.jsxs(K,{"data-loc":"client/src/pages/UserManagement.tsx:148",className:"bg-black/95 border-white/20 text-white",children:[e.jsxs(Z,{"data-loc":"client/src/pages/UserManagement.tsx:149",children:[e.jsx(q,{"data-loc":"client/src/pages/UserManagement.tsx:150",children:"Neuen Benutzer erstellen"}),e.jsx(J,{"data-loc":"client/src/pages/UserManagement.tsx:151",className:"text-gray-400",children:"Erstellen Sie einen neuen Benutzer mit E-Mail und Passwort"})]}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:155",className:"space-y-4 mt-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:156",children:[e.jsx(d,{"data-loc":"client/src/pages/UserManagement.tsx:157",htmlFor:"name",children:"Name"}),e.jsx(p,{"data-loc":"client/src/pages/UserManagement.tsx:158",id:"name",value:s.name,onChange:a=>r({...s,name:a.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"Max Mustermann"})]}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:166",children:[e.jsx(d,{"data-loc":"client/src/pages/UserManagement.tsx:167",htmlFor:"email",children:"E-Mail"}),e.jsx(p,{"data-loc":"client/src/pages/UserManagement.tsx:168",id:"email",type:"email",value:s.email,onChange:a=>r({...s,email:a.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"max@beispiel.ch"})]}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:177",children:[e.jsx(d,{"data-loc":"client/src/pages/UserManagement.tsx:178",htmlFor:"password",children:"Passwort"}),e.jsx(p,{"data-loc":"client/src/pages/UserManagement.tsx:179",id:"password",type:"password",value:s.password,onChange:a=>r({...s,password:a.target.value}),className:"bg-white/5 border-white/10 text-white",placeholder:"Mindestens 8 Zeichen"})]}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:188",children:[e.jsx(d,{"data-loc":"client/src/pages/UserManagement.tsx:189",htmlFor:"role",children:"Rolle"}),e.jsxs(v,{"data-loc":"client/src/pages/UserManagement.tsx:190",value:s.role,onValueChange:a=>r({...s,role:a}),children:[e.jsx(N,{"data-loc":"client/src/pages/UserManagement.tsx:191",className:"bg-white/5 border-white/10 text-white",children:e.jsx(f,{"data-loc":"client/src/pages/UserManagement.tsx:192"})}),e.jsxs(y,{"data-loc":"client/src/pages/UserManagement.tsx:194",children:[e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:195",value:"user",children:"Benutzer"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:196",value:"support",children:"Support"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:197",value:"accounting",children:"Buchhaltung"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:198",value:"admin",children:"Admin"})]})]})]}),e.jsx(i,{"data-loc":"client/src/pages/UserManagement.tsx:202",onClick:D,disabled:x.isPending,className:"w-full bg-primary hover:bg-primary/80",children:x.isPending?"Erstelle...":"Benutzer erstellen"})]})]})]})]})]})}),e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:217",className:"grid gap-4",children:m?.map(a=>e.jsxs(w,{"data-loc":"client/src/pages/UserManagement.tsx:219",className:"bg-white/5 border-white/10",children:[e.jsx(T,{"data-loc":"client/src/pages/UserManagement.tsx:220",children:e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:221",className:"flex items-start justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:222",className:"flex items-center gap-3",children:[P(a.role),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:224",children:[e.jsx(I,{"data-loc":"client/src/pages/UserManagement.tsx:225",className:"text-white",children:a.name||"Unbekannt"}),e.jsxs(O,{"data-loc":"client/src/pages/UserManagement.tsx:226",className:"text-gray-400 flex items-center gap-2 mt-1",children:[e.jsx(C,{"data-loc":"client/src/pages/UserManagement.tsx:227",className:"h-3 w-3"}),a.email||"Keine E-Mail"]})]})]}),e.jsx("div",{"data-loc":"client/src/pages/UserManagement.tsx:232",className:"flex items-center gap-2",children:R(a.role)})]})}),e.jsx(b,{"data-loc":"client/src/pages/UserManagement.tsx:237",children:e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:238",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:239",className:"text-sm text-gray-400",children:[e.jsxs("p",{"data-loc":"client/src/pages/UserManagement.tsx:240",children:["Login-Methode: ",a.loginMethod||"OAuth"]}),e.jsxs("p",{"data-loc":"client/src/pages/UserManagement.tsx:241",children:["Erstellt: ",new Date(a.createdAt).toLocaleDateString("de-DE")]})]}),e.jsxs("div",{"data-loc":"client/src/pages/UserManagement.tsx:243",className:"flex items-center gap-2",children:[e.jsxs(v,{"data-loc":"client/src/pages/UserManagement.tsx:244",value:a.role,onValueChange:c=>E(a.id,c),disabled:M.isPending,children:[e.jsx(N,{"data-loc":"client/src/pages/UserManagement.tsx:249",className:"w-[140px] bg-white/5 border-white/10 text-white",children:e.jsx(f,{"data-loc":"client/src/pages/UserManagement.tsx:250"})}),e.jsxs(y,{"data-loc":"client/src/pages/UserManagement.tsx:252",children:[e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:253",value:"user",children:"Benutzer"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:254",value:"support",children:"Support"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:255",value:"accounting",children:"Buchhaltung"}),e.jsx(t,{"data-loc":"client/src/pages/UserManagement.tsx:256",value:"admin",children:"Admin"})]})]}),e.jsx(i,{"data-loc":"client/src/pages/UserManagement.tsx:259",variant:"ghost",size:"sm",onClick:()=>L(a.id,a.name||"Unbekannt"),disabled:U.isPending,className:"text-red-400 hover:text-red-300 hover:bg-red-500/10",children:e.jsx($,{"data-loc":"client/src/pages/UserManagement.tsx:266",className:"h-4 w-4"})})]})]})})]},a.id))}),!m||m.length===0?e.jsx(w,{"data-loc":"client/src/pages/UserManagement.tsx:276",className:"bg-white/5 border-white/10",children:e.jsxs(b,{"data-loc":"client/src/pages/UserManagement.tsx:277",className:"py-12 text-center",children:[e.jsx(B,{"data-loc":"client/src/pages/UserManagement.tsx:278",className:"h-12 w-12 mx-auto mb-4 text-gray-500"}),e.jsx("p",{"data-loc":"client/src/pages/UserManagement.tsx:279",className:"text-gray-400",children:"Keine Benutzer vorhanden."})]})}):null]})})}export{Ue as default};

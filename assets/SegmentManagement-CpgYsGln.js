import{J as D,j as o,N as S,A as m,x as e}from"./index-BN9GAmQT.js";import{C as B}from"./card-DDCG5iAJ.js";import{B as n}from"./button-B7XicF_D.js";import{I as x}from"./input-DAxyQcQ6.js";import{B as l}from"./badge-DuBy3M6P.js";import{D as E,a as z,b as T,c as L,e as O,f as F}from"./dialog-BFxkyGdG.js";import{T as H,a as I,b as f,c as r,d as K,e as i}from"./table-CCi6V4m7.js";import{A as P}from"./arrow-left-DYl8JD6p.js";import{F as b}from"./filter-CeMfskc8.js";import{P as N}from"./plus-Bs9J4-Yt.js";import{U as $}from"./users-BEPVjVsG.js";import{E as Z}from"./eye-DH5-FCbl.js";import{T as J}from"./trash-2-BGEcaC5X.js";import"./index-Ci_qB1WW.js";import"./index-DkLA8Hun.js";function ge(){const[,M]=D(),[v,g]=o.useState(!1),[R,U]=o.useState(!1),[V,Q]=o.useState(null),[a,c]=o.useState({name:"",description:"",criteria:{status:[],subscribedAfter:"",subscribedBefore:""}}),{data:p,isLoading:w,refetch:j}=S.newsletter.segments.list.useQuery({page:1,pageSize:50}),u=S.newsletter.segments.create.useMutation({onSuccess:t=>{m.success(`Segment erstellt mit ${t.subscriberCount} Abonnenten`),g(!1),c({name:"",description:"",criteria:{status:[],subscribedAfter:"",subscribedBefore:""}}),j()},onError:t=>{m.error(`Fehler: ${t.message}`)}}),y=S.newsletter.segments.delete.useMutation({onSuccess:()=>{m.success("Segment gelöscht"),j()},onError:t=>{m.error(`Fehler: ${t.message}`)}}),k=()=>{if(!a.name){m.error("Name ist erforderlich");return}u.mutate({name:a.name,description:a.description||void 0,criteria:a.criteria})},C=t=>{confirm("Möchten Sie dieses Segment wirklich löschen?")&&y.mutate({id:t})},h=t=>{const s=a.criteria.status||[];s.includes(t)?c({...a,criteria:{...a.criteria,status:s.filter(d=>d!==t)}}):c({...a,criteria:{...a.criteria,status:[...s,t]}})},A=t=>{switch(t){case"active":return e.jsx(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:148",className:"bg-green-500/10 text-green-600 hover:bg-green-500/20",children:"Aktiv"});case"unsubscribed":return e.jsx(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:154",className:"bg-gray-500/10 text-gray-600 hover:bg-gray-500/20",children:"Abgemeldet"});case"bounced":return e.jsx(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:160",className:"bg-red-500/10 text-red-600 hover:bg-red-500/20",children:"Bounced"});default:return null}};return e.jsx("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:170",className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6",children:e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:171",className:"container mx-auto max-w-7xl",children:[e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:173",className:"mb-8",children:[e.jsxs(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:174",onClick:()=>M("/newsletter"),variant:"ghost",className:"mb-4",children:[e.jsx(P,{"data-loc":"client/src/pages/SegmentManagement.tsx:179",className:"w-4 h-4 mr-2"}),"Zurück zum Newsletter"]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:182",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:183",children:[e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:184",className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:185",className:"p-2 bg-purple-500/10 rounded-lg",children:e.jsx(b,{"data-loc":"client/src/pages/SegmentManagement.tsx:186",className:"w-6 h-6 text-purple-600"})}),e.jsx("h1",{"data-loc":"client/src/pages/SegmentManagement.tsx:188",className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Segment-Verwaltung"})]}),e.jsx("p",{"data-loc":"client/src/pages/SegmentManagement.tsx:192",className:"text-gray-600 dark:text-gray-400",children:"Erstellen Sie Zielgruppen für gezielte Newsletter-Kampagnen"})]}),e.jsxs(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:196",onClick:()=>g(!0),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(N,{"data-loc":"client/src/pages/SegmentManagement.tsx:200",className:"w-4 h-4 mr-2"}),"Neues Segment"]})]})]}),e.jsx(B,{"data-loc":"client/src/pages/SegmentManagement.tsx:207",className:"bg-white dark:bg-gray-800",children:e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:208",className:"p-6",children:[e.jsx("h2",{"data-loc":"client/src/pages/SegmentManagement.tsx:209",className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:"Alle Segmente"}),w?e.jsx("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:213",className:"flex justify-center py-12",children:e.jsx("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:214",className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):!p||p.segments.length===0?e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:217",className:"text-center py-12",children:[e.jsx(b,{"data-loc":"client/src/pages/SegmentManagement.tsx:218",className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{"data-loc":"client/src/pages/SegmentManagement.tsx:219",className:"text-gray-500 mb-4",children:"Noch keine Segmente erstellt"}),e.jsxs(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:220",onClick:()=>g(!0),variant:"outline",children:[e.jsx(N,{"data-loc":"client/src/pages/SegmentManagement.tsx:224",className:"w-4 h-4 mr-2"}),"Erstes Segment erstellen"]})]}):e.jsx("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:229",className:"overflow-x-auto",children:e.jsxs(H,{"data-loc":"client/src/pages/SegmentManagement.tsx:230",children:[e.jsx(I,{"data-loc":"client/src/pages/SegmentManagement.tsx:231",children:e.jsxs(f,{"data-loc":"client/src/pages/SegmentManagement.tsx:232",children:[e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:233",children:"Name"}),e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:234",children:"Beschreibung"}),e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:235",children:"Abonnenten"}),e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:236",children:"Kriterien"}),e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:237",children:"Erstellt am"}),e.jsx(r,{"data-loc":"client/src/pages/SegmentManagement.tsx:238",className:"text-right",children:"Aktionen"})]})}),e.jsx(K,{"data-loc":"client/src/pages/SegmentManagement.tsx:241",children:p.segments.map(t=>{const s=JSON.parse(t.criteria);return e.jsxs(f,{"data-loc":"client/src/pages/SegmentManagement.tsx:245",children:[e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:246",className:"font-medium",children:t.name}),e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:249",className:"text-gray-600 dark:text-gray-400",children:t.description||"—"}),e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:252",children:e.jsxs(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:253",variant:"outline",children:[e.jsx($,{"data-loc":"client/src/pages/SegmentManagement.tsx:254",className:"w-3 h-3 mr-1"}),t.subscriberCount]})}),e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:258",children:e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:259",className:"flex flex-wrap gap-1",children:[s.status&&s.status.map(d=>e.jsx("span",{"data-loc":"client/src/pages/SegmentManagement.tsx:262",children:A(d)},d)),s.subscribedAfter&&e.jsxs(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:267",variant:"outline",className:"text-xs",children:["Nach:"," ",new Date(s.subscribedAfter).toLocaleDateString("de-CH")]}),s.subscribedBefore&&e.jsxs(l,{"data-loc":"client/src/pages/SegmentManagement.tsx:275",variant:"outline",className:"text-xs",children:["Vor:"," ",new Date(s.subscribedBefore).toLocaleDateString("de-CH")]})]})}),e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:284",children:new Date(t.createdAt).toLocaleDateString("de-CH")}),e.jsx(i,{"data-loc":"client/src/pages/SegmentManagement.tsx:289",className:"text-right",children:e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:290",className:"flex justify-end gap-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:291",variant:"ghost",size:"sm",onClick:()=>M(`/newsletter/segments/${t.id}/subscribers`),children:e.jsx(Z,{"data-loc":"client/src/pages/SegmentManagement.tsx:300",className:"w-4 h-4"})}),e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:302",variant:"ghost",size:"sm",onClick:()=>C(t.id),children:e.jsx(J,{"data-loc":"client/src/pages/SegmentManagement.tsx:307",className:"w-4 h-4"})})]})})]},t.id)})})]})})]})}),e.jsx(E,{"data-loc":"client/src/pages/SegmentManagement.tsx:322",open:v,onOpenChange:g,children:e.jsxs(z,{"data-loc":"client/src/pages/SegmentManagement.tsx:323",className:"max-w-2xl",children:[e.jsxs(T,{"data-loc":"client/src/pages/SegmentManagement.tsx:324",children:[e.jsx(L,{"data-loc":"client/src/pages/SegmentManagement.tsx:325",children:"Neues Segment erstellen"}),e.jsx(O,{"data-loc":"client/src/pages/SegmentManagement.tsx:326",children:"Definieren Sie Kriterien, um eine Zielgruppe zu erstellen"})]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:330",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:331",children:[e.jsx("label",{"data-loc":"client/src/pages/SegmentManagement.tsx:332",className:"text-sm font-medium mb-2 block",children:"Segment-Name *"}),e.jsx(x,{"data-loc":"client/src/pages/SegmentManagement.tsx:335",placeholder:"z.B. Aktive Abonnenten 2024",value:a.name,onChange:t=>c({...a,name:t.target.value})})]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:343",children:[e.jsx("label",{"data-loc":"client/src/pages/SegmentManagement.tsx:344",className:"text-sm font-medium mb-2 block",children:"Beschreibung"}),e.jsx(x,{"data-loc":"client/src/pages/SegmentManagement.tsx:347",placeholder:"Optionale Beschreibung",value:a.description,onChange:t=>c({...a,description:t.target.value})})]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:359",className:"border-t pt-4",children:[e.jsxs("h3",{"data-loc":"client/src/pages/SegmentManagement.tsx:360",className:"text-sm font-medium mb-3 flex items-center gap-2",children:[e.jsx(b,{"data-loc":"client/src/pages/SegmentManagement.tsx:361",className:"w-4 h-4"}),"Filter-Kriterien"]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:366",className:"mb-4",children:[e.jsx("label",{"data-loc":"client/src/pages/SegmentManagement.tsx:367",className:"text-sm font-medium mb-2 block",children:"Status"}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:370",className:"flex gap-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:371",type:"button",variant:a.criteria.status?.includes("active")?"default":"outline",size:"sm",onClick:()=>h("active"),children:"Aktiv"}),e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:383",type:"button",variant:a.criteria.status?.includes("unsubscribed")?"default":"outline",size:"sm",onClick:()=>h("unsubscribed"),children:"Abgemeldet"}),e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:395",type:"button",variant:a.criteria.status?.includes("bounced")?"default":"outline",size:"sm",onClick:()=>h("bounced"),children:"Bounced"})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:411",className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:412",children:[e.jsx("label",{"data-loc":"client/src/pages/SegmentManagement.tsx:413",className:"text-sm font-medium mb-2 block",children:"Abonniert nach"}),e.jsx(x,{"data-loc":"client/src/pages/SegmentManagement.tsx:416",type:"date",value:a.criteria.subscribedAfter||"",onChange:t=>c({...a,criteria:{...a.criteria,subscribedAfter:t.target.value}})})]}),e.jsxs("div",{"data-loc":"client/src/pages/SegmentManagement.tsx:430",children:[e.jsx("label",{"data-loc":"client/src/pages/SegmentManagement.tsx:431",className:"text-sm font-medium mb-2 block",children:"Abonniert vor"}),e.jsx(x,{"data-loc":"client/src/pages/SegmentManagement.tsx:434",type:"date",value:a.criteria.subscribedBefore||"",onChange:t=>c({...a,criteria:{...a.criteria,subscribedBefore:t.target.value}})})]})]})]})]}),e.jsxs(F,{"data-loc":"client/src/pages/SegmentManagement.tsx:451",children:[e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:452",variant:"outline",onClick:()=>g(!1),children:"Abbrechen"}),e.jsx(n,{"data-loc":"client/src/pages/SegmentManagement.tsx:458",onClick:k,disabled:u.isPending,className:"bg-purple-600 hover:bg-purple-700",children:u.isPending?"Erstelle...":"Segment erstellen"})]})]})})]})})}export{ge as default};

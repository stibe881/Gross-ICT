import{J as u,j as d,N as m,A as r,x as e}from"./index-BN9GAmQT.js";import{C as f,a as h,b as p,c as b,d as C}from"./card-DDCG5iAJ.js";import{L as M}from"./loader-circle-ClqFH6Ch.js";function A(){const[,c]=u(),[s,l]=d.useState(null),x=m.useUtils(),g=m.microsoftOAuth.handleCallback.useMutation({onSuccess:async t=>{r.success(`Willkommen, ${t.user.name}!`),await x.auth.me.invalidate();const a=t.returnUrl||"/dashboard";c(a)},onError:t=>{l(t.message||"Microsoft-Anmeldung fehlgeschlagen"),r.error(t.message||"Microsoft-Anmeldung fehlgeschlagen")}});return d.useEffect(()=>{const t=new URLSearchParams(window.location.search),a=t.get("code"),n=t.get("state"),o=t.get("error"),i=t.get("error_description");if(o){l(i||o),r.error(`Microsoft-Fehler: ${i||o}`),setTimeout(()=>{c("/login")},3e3);return}if(!a||!n){l("Fehlende Authentifizierungsparameter"),r.error("Fehlende Authentifizierungsparameter"),setTimeout(()=>{c("/login")},3e3);return}g.mutate({code:a,state:n})},[]),e.jsx("div",{"data-loc":"client/src/pages/MicrosoftCallback.tsx:61",className:"min-h-screen flex items-center justify-center bg-black px-4",children:e.jsxs(f,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:62",className:"w-full max-w-md bg-white/5 border-white/10 backdrop-blur-xl",children:[e.jsxs(h,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:63",children:[e.jsx(p,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:64",className:"text-2xl font-bold text-white text-center",children:s?"Anmeldung fehlgeschlagen":"Microsoft-Anmeldung"}),e.jsx(b,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:67",className:"text-gray-400 text-center",children:s?"Es gab ein Problem bei der Anmeldung":"Sie werden angemeldet..."})]}),e.jsx(C,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:73",className:"flex flex-col items-center space-y-4",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{"data-loc":"client/src/pages/MicrosoftCallback.tsx:76",className:"text-red-400 text-sm text-center",children:s}),e.jsx("p",{"data-loc":"client/src/pages/MicrosoftCallback.tsx:77",className:"text-gray-400 text-sm",children:"Sie werden zur Login-Seite weitergeleitet..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{"data-loc":"client/src/pages/MicrosoftCallback.tsx:83",className:"h-12 w-12 animate-spin text-primary"}),e.jsx("p",{"data-loc":"client/src/pages/MicrosoftCallback.tsx:84",className:"text-gray-400 text-sm",children:"Bitte warten Sie, w√§hrend wir Ihre Microsoft-Anmeldung verarbeiten..."})]})})]})})}export{A as default};

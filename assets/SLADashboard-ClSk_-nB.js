import{j,N as f,x as e,T as F,L as N,A as M}from"./index-BN9GAmQT.js";import{C as l,a as i,b as n,d,c as u}from"./card-DDCG5iAJ.js";import{B as v}from"./badge-DuBy3M6P.js";import{B as m}from"./button-B7XicF_D.js";import{T as E,a as H,b as k,c as x,d as V,e as h}from"./table-CCi6V4m7.js";import{A as K}from"./activity-DPO21zOx.js";import{R as O}from"./refresh-cw-DbwZ9LS7.js";import{C as P}from"./clock-C0SPg0PF.js";import{T as Q}from"./trending-up-q9Xt4TNZ.js";import{C as D}from"./circle-check-CegIR20y.js";import{T as U}from"./trending-down-DxdrgmSb.js";import"./index-Ci_qB1WW.js";function ce(){const[o,w]=j.useState(!0),{data:t,refetch:p}=f.sla.getBreaches.useQuery(),{data:r}=f.sla.list.useQuery();j.useEffect(()=>{if(!o)return;const s=setInterval(()=>{p()},3e4);return()=>clearInterval(s)},[o,p]);const T=()=>{p(),M.success("Dashboard aktualisiert")},A=t?.filter(s=>s.resolutionStatus==="breached").length||0,y=t?.filter(s=>s.resolutionStatus==="warning").length||0,R=t?.filter(s=>s.resolutionStatus==="pending").length||0,b=t&&t.length>0?(A/t.length*100).toFixed(1):"0.0",g=t?.filter(s=>{if(s.resolutionStatus==="breached"||!s.ticket.slaDueDate)return!1;const a=new Date(s.ticket.slaDueDate).getTime()-Date.now();return a>0&&a<3600*1e3})||[],C=r&&r.length>0?Math.round(r.reduce((s,a)=>s+a.responseTimeMinutes,0)/r.length):0,z=r&&r.length>0?Math.round(r.reduce((s,a)=>s+a.resolutionTimeMinutes,0)/r.length):0,S=s=>{if(s<60)return`${s}min`;const a=Math.floor(s/60),c=s%60;return c>0?`${a}h ${c}min`:`${a}h`},L=s=>{const a=new Date(s).getTime()-Date.now();if(a<0)return"Überfällig";const c=Math.floor(a/(1e3*60));if(c<60)return`${c}min`;const B=Math.floor(c/60),$=c%60;return`${B}h ${$}min`},I=s=>{const a={urgent:{variant:"destructive",label:"Dringend"},high:{variant:"default",label:"Hoch"},normal:{variant:"secondary",label:"Normal"},low:{variant:"outline",label:"Niedrig"}},c=a[s]||a.normal;return e.jsx(v,{"data-loc":"client/src/pages/SLADashboard.tsx:101",variant:c.variant,children:c.label})};return e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:105",className:"container mx-auto py-8",children:[e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:106",className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:107",children:[e.jsx("h1",{"data-loc":"client/src/pages/SLADashboard.tsx:108",className:"text-3xl font-bold",children:"SLA-Dashboard"}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:109",className:"text-muted-foreground",children:"Echtzeit-Überwachung Ihrer Service Level Agreements"})]}),e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:111",className:"flex gap-2",children:[e.jsxs(m,{"data-loc":"client/src/pages/SLADashboard.tsx:112",variant:"outline",size:"sm",onClick:()=>w(!o),"aria-label":o?"Auto-Refresh deaktivieren":"Auto-Refresh aktivieren",children:[e.jsx(K,{"data-loc":"client/src/pages/SLADashboard.tsx:118",className:`h-4 w-4 mr-2 ${o?"text-green-500":""}`,"aria-hidden":"true"}),o?"Auto-Refresh An":"Auto-Refresh Aus"]}),e.jsxs(m,{"data-loc":"client/src/pages/SLADashboard.tsx:121",variant:"outline",size:"sm",onClick:T,"aria-label":"Dashboard manuell aktualisieren",children:[e.jsx(O,{"data-loc":"client/src/pages/SLADashboard.tsx:127",className:"h-4 w-4 mr-2","aria-hidden":"true"}),"Aktualisieren"]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:134",className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4 mb-8",children:[e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:135",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:136",className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:137",className:"text-sm font-medium",children:"Aktive Tickets"}),e.jsx(P,{"data-loc":"client/src/pages/SLADashboard.tsx:138",className:"h-4 w-4 text-muted-foreground","aria-hidden":"true"})]}),e.jsxs(d,{"data-loc":"client/src/pages/SLADashboard.tsx:140",children:[e.jsx("div",{"data-loc":"client/src/pages/SLADashboard.tsx:141",className:"text-2xl font-bold",children:R}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:142",className:"text-xs text-muted-foreground",children:"mit aktivem SLA"})]})]}),e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:146",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:147",className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:148",className:"text-sm font-medium",children:"SLA-Verletzungen"}),e.jsx(F,{"data-loc":"client/src/pages/SLADashboard.tsx:149",className:"h-4 w-4 text-destructive","aria-hidden":"true"})]}),e.jsxs(d,{"data-loc":"client/src/pages/SLADashboard.tsx:151",children:[e.jsx("div",{"data-loc":"client/src/pages/SLADashboard.tsx:152",className:"text-2xl font-bold text-destructive",children:A}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:153",className:"text-xs text-muted-foreground",children:"in den letzten 30 Tagen"})]})]}),e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:157",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:158",className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:159",className:"text-sm font-medium",children:"Warnungen"}),e.jsx(Q,{"data-loc":"client/src/pages/SLADashboard.tsx:160",className:"h-4 w-4 text-yellow-500","aria-hidden":"true"})]}),e.jsxs(d,{"data-loc":"client/src/pages/SLADashboard.tsx:162",children:[e.jsx("div",{"data-loc":"client/src/pages/SLADashboard.tsx:163",className:"text-2xl font-bold text-yellow-600",children:y}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:164",className:"text-xs text-muted-foreground",children:"nahe am Fristablauf"})]})]}),e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:168",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:169",className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:170",className:"text-sm font-medium",children:"Breach-Rate"}),parseFloat(b)<10?e.jsx(D,{"data-loc":"client/src/pages/SLADashboard.tsx:172",className:"h-4 w-4 text-green-500","aria-hidden":"true"}):e.jsx(U,{"data-loc":"client/src/pages/SLADashboard.tsx:174",className:"h-4 w-4 text-destructive","aria-hidden":"true"})]}),e.jsxs(d,{"data-loc":"client/src/pages/SLADashboard.tsx:177",children:[e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:178",className:`text-2xl font-bold ${parseFloat(b)<10?"text-green-600":"text-destructive"}`,children:[b,"%"]}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:181",className:"text-xs text-muted-foreground",children:"der Tickets verletzt"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:187",className:"grid gap-4 md:grid-cols-2 mb-8",children:[e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:188",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:189",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:190",children:"Durchschnittliche Zeiten"}),e.jsx(u,{"data-loc":"client/src/pages/SLADashboard.tsx:191",children:"Basierend auf aktiven SLA-Richtlinien"})]}),e.jsx(d,{"data-loc":"client/src/pages/SLADashboard.tsx:193",children:e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:194",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:195",className:"flex items-center justify-between",children:[e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:196",className:"text-sm font-medium",children:"Reaktionszeit:"}),e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:197",className:"text-lg font-bold",children:S(C)})]}),e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:199",className:"flex items-center justify-between",children:[e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:200",className:"text-sm font-medium",children:"Lösungszeit:"}),e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:201",className:"text-lg font-bold",children:S(z)})]}),e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:203",className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:204",className:"text-sm font-medium",children:"Aktive Richtlinien:"}),e.jsx("span",{"data-loc":"client/src/pages/SLADashboard.tsx:205",className:"text-lg font-bold",children:r?.filter(s=>s.isActive).length||0})]})]})})]}),e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:211",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:212",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:213",children:"Tickets nahe am Fristablauf"}),e.jsx(u,{"data-loc":"client/src/pages/SLADashboard.tsx:214",children:"Innerhalb der nächsten Stunde"})]}),e.jsx(d,{"data-loc":"client/src/pages/SLADashboard.tsx:216",children:g.length>0?e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:218",className:"space-y-2",children:[g.slice(0,3).map(s=>e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:220",className:"flex items-center justify-between p-2 rounded-lg bg-yellow-50 dark:bg-yellow-900/20",children:[e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:221",children:[e.jsxs("p",{"data-loc":"client/src/pages/SLADashboard.tsx:222",className:"text-sm font-medium",children:["Ticket #",s.ticketId]}),e.jsxs("p",{"data-loc":"client/src/pages/SLADashboard.tsx:223",className:"text-xs text-muted-foreground",children:[s.ticket.slaDueDate&&L(new Date(s.ticket.slaDueDate).toISOString())," verbleibend"]})]}),e.jsx(N,{"data-loc":"client/src/pages/SLADashboard.tsx:227",href:"/fernwartung/tickets",children:e.jsx(m,{"data-loc":"client/src/pages/SLADashboard.tsx:228",variant:"ghost",size:"sm","aria-label":`Ticket ${s.ticketId} anzeigen`,children:"Anzeigen"})})]},s.ticketId)),g.length>3&&e.jsxs("p",{"data-loc":"client/src/pages/SLADashboard.tsx:235",className:"text-xs text-muted-foreground text-center pt-2",children:["+",g.length-3," weitere Tickets"]})]}):e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:241",className:"text-center py-8 text-muted-foreground",children:[e.jsx(D,{"data-loc":"client/src/pages/SLADashboard.tsx:242",className:"h-12 w-12 mx-auto mb-2 text-green-500","aria-hidden":"true"}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:243",children:"Keine Tickets nahe am Fristablauf"})]})})]})]}),e.jsxs(l,{"data-loc":"client/src/pages/SLADashboard.tsx:251",children:[e.jsxs(i,{"data-loc":"client/src/pages/SLADashboard.tsx:252",children:[e.jsx(n,{"data-loc":"client/src/pages/SLADashboard.tsx:253",children:"Aktuelle SLA-Verletzungen"}),e.jsx(u,{"data-loc":"client/src/pages/SLADashboard.tsx:254",children:"Tickets, die ihre SLA-Fristen überschritten haben"})]}),e.jsx(d,{"data-loc":"client/src/pages/SLADashboard.tsx:256",children:t&&t.filter(s=>s.resolutionStatus==="breached").length>0?e.jsxs(E,{"data-loc":"client/src/pages/SLADashboard.tsx:258",children:[e.jsx(H,{"data-loc":"client/src/pages/SLADashboard.tsx:259",children:e.jsxs(k,{"data-loc":"client/src/pages/SLADashboard.tsx:260",children:[e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:261",children:"Ticket"}),e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:262",children:"Priorität"}),e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:263",children:"Fällig"}),e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:264",children:"Überfällig seit"}),e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:265",children:"Eskalation"}),e.jsx(x,{"data-loc":"client/src/pages/SLADashboard.tsx:266",className:"text-right",children:"Aktion"})]})}),e.jsx(V,{"data-loc":"client/src/pages/SLADashboard.tsx:269",children:t.filter(s=>s.resolutionStatus==="breached").slice(0,10).map(s=>e.jsxs(k,{"data-loc":"client/src/pages/SLADashboard.tsx:274",children:[e.jsxs(h,{"data-loc":"client/src/pages/SLADashboard.tsx:275",className:"font-medium",children:["#",s.ticketId]}),e.jsx(h,{"data-loc":"client/src/pages/SLADashboard.tsx:276",children:I(s.ticket.priority)}),e.jsx(h,{"data-loc":"client/src/pages/SLADashboard.tsx:277",children:s.ticket.slaDueDate&&new Date(s.ticket.slaDueDate).toLocaleString("de-DE")}),e.jsx(h,{"data-loc":"client/src/pages/SLADashboard.tsx:280",className:"text-destructive font-medium",children:s.ticket.slaDueDate&&L(new Date(s.ticket.slaDueDate).toISOString())}),e.jsx(h,{"data-loc":"client/src/pages/SLADashboard.tsx:283",children:e.jsxs(v,{"data-loc":"client/src/pages/SLADashboard.tsx:284",variant:"outline",children:["Level ",s.ticket.escalationLevel]})}),e.jsx(h,{"data-loc":"client/src/pages/SLADashboard.tsx:286",className:"text-right",children:e.jsx(N,{"data-loc":"client/src/pages/SLADashboard.tsx:287",href:"/fernwartung/tickets",children:e.jsx(m,{"data-loc":"client/src/pages/SLADashboard.tsx:288",variant:"ghost",size:"sm","aria-label":`Ticket ${s.ticketId} anzeigen`,children:"Anzeigen"})})})]},s.ticketId))})]}):e.jsxs("div",{"data-loc":"client/src/pages/SLADashboard.tsx:298",className:"text-center py-12 text-muted-foreground",children:[e.jsx(D,{"data-loc":"client/src/pages/SLADashboard.tsx:299",className:"h-16 w-16 mx-auto mb-4 text-green-500","aria-hidden":"true"}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:300",className:"text-lg font-medium",children:"Keine SLA-Verletzungen!"}),e.jsx("p",{"data-loc":"client/src/pages/SLADashboard.tsx:301",className:"text-sm",children:"Alle Tickets werden innerhalb ihrer SLA-Fristen bearbeitet."})]})})]})]})}export{ce as default};
